# This file is adapted from coraza-proxy-wasm/ftw/ftw.yml
# Original work: Copyright 2022 The OWASP Coraza contributors
# Adapted for coraza-rs dynamic module implementation

# FTW-specific configuration for Coraza WAF
# This file contains rules needed for running FTW (Framework for Testing WAFs) tests

# Response body MIME types
SecResponseBodyMimeType text/plain text/html text/xml application/json

# Default actions for phases 3, 4, and 5
SecDefaultAction "phase:3,log,auditlog,pass"
SecDefaultAction "phase:4,log,auditlog,pass"
SecDefaultAction "phase:5,log,auditlog,pass"

# Debug log level
SecDebugLogLevel 3

# FTW-specific configuration rule
SecAction "id:900005,phase:1,nolog,pass,ctl:ruleEngine=DetectionOnly,ctl:ruleRemoveById=910000,setvar:tx.blocking_paranoia_level=4,setvar:tx.crs_validate_utf8_encoding=1,setvar:tx.arg_name_length=100,setvar:tx.arg_length=400,setvar:tx.total_arg_length=64000,setvar:tx.max_num_args=255,setvar:tx.max_file_size=64100,setvar:tx.combined_file_sizes=65535"

# X-CRS-Test header rule for FTW test identification
SecRule REQUEST_HEADERS:X-CRS-Test "@rx ^.*$" "id:999999,phase:1,pass,t:none,log,msg:'X-CRS-Test %{MATCHED_VAR}',ctl:ruleRemoveById=1-999999"
